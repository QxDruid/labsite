{% extends "base.html" %}

{% block title %}
    Публикации
{% endblock %} 

{% block content %}
<div class="conteiner" style="min-height: 100vh;">

    <div class="row" style="margin: 10px auto;">
        <div class="col-3" style="margin: 0 auto;">
            <div class="list-group" style="text-align: center;">
                {% for year in years %}
                <a href="{{url_for('main.public', active_year=year)}}" class="list-group-item list-group-item-action {% if active_year == year %} active {% endif %}">
                    {{year}}
                </a>
                {% endfor %}

            </div>
        </div>
        <div class="col-9" style="margin: 0 auto;">
          {% if current_user.is_authenticated %}
    
          <div class="col-xl-6" style="margin: 10px auto; ">
            <div style="border:1px solid black; border-radius:10px; padding: 5px;">
            <form enctype="multipart/form-data" action="" method='post' novalidate >
                <div class="form-group">
                  {{ form.csrf_token() }}
                <div class="form-group">
                  {{ form.year.label }}
                  {% with messages = get_flashed_messages(category_filter=["error_year"]) %}
                    {% for  message in messages %}
                      <div class="alert alert-danger" role="alert">
                        {{ message }}
                      </div>  
                    {% endfor %}
                  {% endwith %}
                  {{ form.year(class="form-control") }}
                </div>
                <div class="form-group">
                    {{ form.text.label }}
                    {% with messages = get_flashed_messages(category_filter=["error_ref"]) %}
                      {% for  message in messages %}
                        <div class="alert alert-danger" role="alert">
                          {{ message }}
                        </div>  
                      {% endfor %}
                    {% endwith %}
                    {{ form.text(class="form-control") }}
                  </div>
                  <div class="form-group">
                    {{ form.doi.label }}
                    {% with messages = get_flashed_messages(category_filter=["error_doi"]) %}
                      {% for  message in messages %}
                        <div class="alert alert-danger" role="alert">
                          {{ message }}
                        </div>  
                      {% endfor %}
                    {% endwith %}
                    {{ form.doi(class="form-control") }}
                  </div>
    
                <div class="form-group">
                <div style="text-align: center;"> 
                  {{ form.submit(class="btn btn-dark") }}
                </div>
                </div>
              </form>
            </div>
            </div>
        </div>
      
            {% endif %}

            {% for public in publics %}
              <div style="text-align: justify; border-bottom:1px dashed black; padding: 10px 0;">
                {% if current_user.is_authenticated %}
                <div>
                  <form action="" method="POST"  style="display: inline-block;">
                  {{ formDelete.csrf_token() }}
                  {{ formDelete.Id(value = public.id) }}
                  {{ formDelete.submitDelete(class="btn btn-dark") }}
                  </form>
                  <button type="button" class="btn btn-dark">
                    <a href="{{ url_for('main.editpublication', id=public.id) }}" style="text-decoration: none; color:white;">Редактировать</a>
                  </button>
                </div>
                {% endif %}
                  <div>
                    {{public.Text}}<span style="color: blue;"> {{public.DOI}}</span>
                  </div>
              </div>
            {% endfor %}
          </div>
    </div>
</div>
{% endblock %} 

